

:250805 +++++++++++++++++

curl -X POST http://localhost:8089/api/emva/generate \
  -H "Content-Type: application/json" \
  -d '{
    "pan": "5081470082639565",
    "atc": "0001",
    "unpredictableNumber": "A1B2C3D4",
    "transactionData": "0000000010000000000000000840000000000008402503138030901B6A18000001A00001020000"
  }'

echo '[AOEMVA;KP8EED8C7283AC92C7;KT0000000010000000000000000840000000000008402503138030901B6A18000001A00001020000;]' \
  | nc localhost 9100

:end +++++++++++++++++

üü¢ mongodb

  ‚ñ∂Ô∏é docker run -d -p 27017:27017 \
    --network mongo-network \
    --name mongodb \
    -e MONGO_INITDB_ROOT_USERNAME=admin \
    -e MONGO_INITDB_ROOT_PASSWORD=Passw0rd \
    -v /Users/khalid/@main/@projects/docker/datadir/mongodb:/data/db \
    mongo

  ‚ñ∂Ô∏é mongosh mongodb://admin:Passw0rd@localhost:27017/hsmdb?authSource=admin

  ‚ñ∂Ô∏é docker ps
    CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                                             NAMES
    1cc33dcd442a   mongo     "docker-entrypoint.s‚Ä¶"   12 seconds ago   Up 12 seconds   0.0.0.0:27017->27017/tcp, [::]:27017->27017/tcp   mongodb


context:

  <send>
      ------------ Request ------------
  <message command='EMVA'>
  <token id='FS' value='1'/>
  <token id='KM' value='3'/>
  <token id='CH' value='1'/>
  <token id='KP' value='4E08************************6FD9'/>
  <token id='KQ' value='************5106'/>
  <token id='KR' value='00'/>
  <token id='KS' value='0001'/>
  <token id='KT' value='0000000010000000000000000840000000000008402503130030901B6A18000001A00001020000'/>
  <token id='BO' value='E93273C565E5D0C1'/>
  <token id='BJ' value='0012'/>
  <token id='KU' value='30901B6A'/>
  </message>
      RAW(SND): [AOEMVA;FS1;KM3;CH1;KP4E086729B8D36FD94E086729B8D36FD9;KQ5081470082665106;KR00;KS0001;KT0000000010000000000000000840000000000008402503130030901B6A18000001A00001020000;BOE93273C565E5D0C1;BJ0012;KU30901B6A;]
       elapsed: 572ms
      ------------ Response ------------
  <message command='ERRO'>
  <token id='AM' value='50'/>
  <token id='AN' value='AO'/>
  <token id='BB' value='USER NOT LOGGED IN'/>
  </message>
      RAW(RCV): [AOERRO;AM50;ANAO;BBUSER NOT LOGGED IN;]
  </send>
  </log>
  ","process.thread.name":"Vantiv1.inbound.financial.trxmgr.server:8 prepare com.acs.eppic.fes.iserver.q2.trxmgr.participants.emv.hsm.CheckARQC 2025-04-23T22:32:29.929554171","log.logger":"FES","correlationId":"ad7f5ffe-10e5-4808-8040-81fbe3304a11","debug":"true"}

  x 5F2A-02-0840
      82-02-1800
      84-07-A0000000044542
      95-05-0000000000
      9A-03-250313
      9C-01-00
  x 9F02-06-000000001000
  x 9F03-06-000000000000
  x 9F10-12-0001A00001020000000000000000000000FF
  x 9F1A-02-0840
  x 9F27-01-80
    9F33-03-604000
    9F34-03-020000
    9F36-02-0001 
    9F37-04-30901B6A
  ‚ú™ 9F26-08-EB29837282AEB12A

  9F02  000000001000
  9F03  000000000000
  5F2A  0840
    95  0000000000
  9F1A  0840
    9A  250313
  9F27  00
  9F37  30901B6A
    82  1800
  9F36  0001
   CVR  A00001020000 (CVR part of 9F10)

  000000001000 000000000000 0840 0000000000 0840 250313 00 30901B6A 1800 0001 A00001020000

curl -X POST http://localhost:8089/api/parse/field55\
  -H "Content-Type: application/json" \
  -d '{
    "pan": "5081470082639564",
    "expiryDate": "3003",
    "serviceCode": "101",
    "field55": "5F2A020840820218008407A0000000044542950500000000009A032503139C01009F02060000000010009F03060000000000009F10120001A00001020000000000000000000000FF9F1A0208409F2608EB29837282AEB12A9F2701809F33036040009F34030200009F360200019F370430901B6A",
    "amount": 10000,
    "transactionCurrencyCode": "0840",
    "terminalCountryCode": "0840",
    "unpredictableNumber": "A1B2C3D4"
   }'

   {"txnData":"0000000010000000000000000840000000000008402503138030901B6A18000001A00001020000"}
   ‚èé


EMV tag 9F27, also known as the Cryptogram Information Data (CID), is a 1-byte field that serves an essential role in EMV transaction processing. It indicates:
  ‚Ä¢ The type of cryptogram generated by the ICC (chip card)
  ‚Ä¢ Suggested actions the terminal or issuer should perform following this cryptogram‚Äôs generation

  Structure of 9F27 (CID)
    Bit 8 | Bit 7 | Bit 6 | Bit 5 | Bit 4 | Bit 3 | Bit 2 | Bit 1
      x       x       x       x       x       x       x       x

  Most often, in online transactions, you‚Äôll see:
    ‚Ä¢ 80: ARQC (request online authorization)
    ‚Ä¢ 40: TC (offline approval)
    ‚Ä¢ 00: AAC (offline decline)

  The value 80 (10000000) from your example indicates clearly that:
    ‚Ä¢ Cryptogram Type = ARQC: Transaction must go online.
    ‚Ä¢ Terminal Advice = No specific advice: ICC doesn‚Äôt advise decline or mandatory action; just requires online authorization.

  9F27 Practical Use Case of CID (9F27):
    ‚ú™ The ICC (card) generates a cryptogram (ARQC, TC, AAC) after analyzing internal decision criteria and risk management data.
    ‚ú™ Tag 9F27 communicates this cryptogram type and any action recommendation clearly to the terminal.
    ‚ú™ The Terminal uses the cryptogram type and terminal advice to:
      ‚Ä¢ Decide whether to send the transaction online (ARQC).
      ‚Ä¢ Approve offline (TC).
      ‚Ä¢ Decline immediately offline (AAC).




:dne

